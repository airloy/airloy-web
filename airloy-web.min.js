(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t(require("airloy")):typeof define==="function"&&define.amd?define(["airloy"],t):e.AirloyWeb=t(e.airloy)})(this,function(e){"use strict";var t=function(){function e(e){this.value=e}function t(t){var n,r;function i(e,t){return new Promise(function(i,u){var a={key:e,arg:t,resolve:i,reject:u,next:null};if(r){r=r.next=a}else{n=r=a;o(e,t)}})}function o(n,r){try{var i=t[n](r);var a=i.value;if(a instanceof e){Promise.resolve(a.value).then(function(e){o("next",e)},function(e){o("throw",e)})}else{u(i.done?"return":"normal",i.value)}}catch(e){u("throw",e)}}function u(e,t){switch(e){case"return":n.resolve({value:t,done:true});break;case"throw":n.reject(t);break;default:n.resolve({value:t,done:false});break}n=n.next;if(n){o(n.key,n.arg)}else{r=null}}this._invoke=i;if(typeof t.return!=="function"){this.return=undefined}}if(typeof Symbol==="function"&&Symbol.asyncIterator){t.prototype[Symbol.asyncIterator]=function(){return this}}t.prototype.next=function(e){return this._invoke("next",e)};t.prototype.throw=function(e){return this._invoke("throw",e)};t.prototype.return=function(e){return this._invoke("return",e)};return{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}();var n=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var i=function e(t,n,r){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,n);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,n,r)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(r)}};var o=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t};var u=function(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e};var a=function e(t,n,r,i){var o=Object.getOwnPropertyDescriptor(t,n);if(o===undefined){var u=Object.getPrototypeOf(t);if(u!==null){e(u,n,r,i)}}else if("value"in o&&o.writable){o.value=r}else{var a=o.set;if(a!==undefined){a.call(i,r)}}return r};var f=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else{return Array.from(e)}};var l=function(e){o(t,e);function t(e){n(this,t);var r=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.init(e.airloy);return r}r(t,[{key:"init",value:function e(t){var n=t.store.getItem("airloy.device.id");if(n){this._identifier=n}else{this._identifier=window.navigator.userAgent+"^"+this.createGuid();t.store.setItem("airloy.device.id",this._identifier)}}},{key:"createGuid",value:function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e==="x"?t:t&3|8;return n.toString(16)})}},{key:"getIdentifier",value:function e(){return this._identifier}}]);return t}(e.Device);if(typeof window.CustomEvent!=="function"){var c=function e(t,n){n=n||{bubbles:false,cancelable:false,detail:undefined};var r=document.createEvent("CustomEvent");r.initCustomEvent(t,n.bubbles,n.cancelable,n.detail);return r};c.prototype=window.Event.prototype;window.CustomEvent=c}var s=function(e){o(t,e);function t(){n(this,t);var e=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._events=[];return e}r(t,[{key:"on",value:function e(t,n){this._events[t]=this._events[t]||[];var r=function e(t){n.apply(undefined,f(t.detail))};this._events[t].push(r);document.body.addEventListener(t,r,false)}},{key:"once",value:function e(t,n){var r=this;this._off(t);var i=function e(i){n.apply(undefined,f(i.detail));r._off(t)};this._events[t]=[i];document.body.addEventListener(t,i,false)}},{key:"_off",value:function e(t){if(this._events[t]){this._events[t].forEach(function(e){document.body.removeEventListener(t,e,false)});this._events[t]=null}}},{key:"emit",value:function e(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++){r[i-1]=arguments[i]}var o=new CustomEvent(t,{detail:r});document.body.dispatchEvent(o)}}]);return t}(e.Event);var v=window.localStorage||window.sessionStorage;var y=function(e){o(t,e);function t(){n(this,t);return u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}r(t,[{key:"getItem",value:function e(t){return v.getItem(t)}},{key:"setItem",value:function e(t,n){v.setItem(t,n)}},{key:"removeItem",value:function e(t){v.removeItem(t)}}]);return t}(e.Store);var d={install:function e(t){t.store=new y;t.device=new l({airloy:t});t.event=new s}};return d});